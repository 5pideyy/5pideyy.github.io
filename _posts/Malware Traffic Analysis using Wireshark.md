# **BurninCandle Writeup| IcedID Malware**


![R.D.Tarun](https://miro.medium.com/v2/resize:fill:55:55/1*PuSdkMMVoTmllYolI3tTKQ.jpeg)


[R.D.Tarun](https://medium.com/@tarunrd77)

Hi all, I’m back again with another Malware Analysis Writeup!!

Challenge Link—[https://www.malware-traffic-analysis.net/2022/03/21/index3.html](https://www.malware-traffic-analysis.net/2022/03/21/index3.html)

_________________________________________________________________

**Scenario**

LAN segment data:

- LAN segment range: 10.0.19[.]0/24 (10.0.19[.]0 through 10.0.19[.]255)
- Domain: burnincandle[.]com
- Domain controller: 10.0.19[.]9 — BURNINCANDLE-DC
- LAN segment gateway: 10.0.19[.]1
- LAN segment broadcast address: 10.0.19[.]255

_________________________________________________________________

**Task :** Write an incident report based on the pcap. The incident report should contains 3 sections:

- **Executive Summary**: State in simple, direct terms what happened (when, who, what).
- **Details**: Details of the victim (hostname, IP address, MAC address, Windows user account name).
- **Indicators of Compromise (IOCs)**: IP addresses, domains and URLs associated with the infection. SHA256 hashes if any malware binaries can be extracted from the pcap.

_________________________________________________________________

**Let’s Start!!**

To figure out the Details part,

I decided to filter out kerberos packets and particularly the ones with AS-REQ , by using

> kerberos.msg_type eq 10

![](https://miro.medium.com/v2/resize:fit:875/1*Q5EW9WVqHBT7QiGTtqhnIg.png)

Filtering out AS-REQ Packets

Checking all the packets present there, we are able to figure out the names of Users and Devices.

![](https://miro.medium.com/v2/resize:fit:875/1*45ilYf5VWZkwA3JibTTo2A.png)

Name of the User

![](https://miro.medium.com/v2/resize:fit:875/1*nu6R0r5HIRN8-9FAvIZM5Q.png)

Name of the Device

![](https://miro.medium.com/v2/resize:fit:875/1*TafzRin9oT8uEumq5Fhvgw.png)

Figuring out the Source Address

Decided to just see the requests made by using

> http.request

![](https://miro.medium.com/v2/resize:fit:1250/1*7cmOdpnBcJKwxmxlDwfepg.png)

Examining the URL (https://oceriesfornot.top/) in VirusTotal,

![](https://miro.medium.com/v2/resize:fit:875/1*yfPyJFK9AGpAH0DcKseZXw.png)

Virustotal findings

![](https://miro.medium.com/v2/resize:fit:875/1*4ivQGxlq99331-Y3PK_YVA.png)

Decided to follow the TCP stream to check if anything can be revealed…

![](https://miro.medium.com/v2/resize:fit:875/1*S74owEn7WUQwy7IVgsgZuw.png)

TCP Stream data

> Was fascinated by the “cookie” part, so checked what each of them meant…
> 
> Notable cookies:
> 
> `**_gads**`: Google Ads tracking.
> 
> `**_ga**` and `**_gid**`: Google Analytics for user tracking.
> 
> `**_gat**`: Limits requests to Google's servers.
> 
> `**_u**` **and** `**_io**`: Custom session/user identifiers.

Since _u meant ‘user’ and the info associated with it looked hex-encrypted, I decided to use [cyberchef.io](https://cyberchef.io/) to decrypt the info.

![](https://miro.medium.com/v2/resize:fit:875/1*J5dAFkQcZJ2Q8_y1hj7WoA.png)

Using Cyberchef to decrypt the encoded text

And voila!! We have the complete information of the data.

> **DESKTOP-5QS3D5Dpatrick.zimmermanCD2F3B9F67E3C343**

So, this confirms that our analyses related to the details were accurate.

Now I decided to export the documents associated with the packet.

![](https://miro.medium.com/v2/resize:fit:691/1*PYBidm2ED29AySdAqMJEbQ.png)

Analyzing the files, we find that the gzip file is called “Copper.txt”, which is…let's just say…HIGHLY UNUSUAL.

![](https://miro.medium.com/v2/resize:fit:875/1*rXRCN4fkmNohNVsR5EoB2A.png)

I decided to check the file hash with some security vendors like VirusTotal,

![](https://miro.medium.com/v2/resize:fit:875/1*PvAo1J_-v4Q7o-0r1l8chg.png)

aaaanddd….

![](https://miro.medium.com/v2/resize:fit:875/1*rUbHXjtjz1LO6eVf9Gcuug.png)

WOW. Not Malicious?? Maybe it was a false alarm, or I fell into a trap.

I decided to filter for DNS traffic in wireshark, as DNS traffic can reveal what domains and IP addresses threat actors are using to conduct their malicious activities.

And boom!! Noticed something off.

![](https://miro.medium.com/v2/resize:fit:875/1*5HYHXKWPhmSMvjCNiInjUw.png)

The websites **filebin.net** and **situla.bitbit.net** were visited briefly, with each connection lasting less than 10 seconds. This could mean 2 things:

1. Data was being stolen, or
2. The malware was downloading more files to harm the system.

But we aren’t sure yet. It is unclear right now.

I checked the sites on VirusTotal,

![](https://miro.medium.com/v2/resize:fit:875/1*fmdaQmkZ9b9m-sYqMDYQ0g.png)

Checking the Community Tab,

![](https://miro.medium.com/v2/resize:fit:388/1*bVjTkLMIzlHVZKjHd0q1hg.png)

A user drb_ra has given everything related to this. Analysis of this data indicates that the server is flagged as a **Cobalt Strike Command-and-Control (C2)** server.

And yeahhh, it seems like I finally got what’s the problem here.

Upon further research, I found out that a malware type **_IcedID_** uses this technique as the first stage loading mechanism (Check out this amazing website — [https://www.binarydefense.com/resources/blog/icedid-gziploader-analysis/](https://www.binarydefense.com/resources/blog/icedid-gziploader-analysis/))

IcedID , CobaltStrike — we’re getting somewhere…..I think I can wrap it off by the analyis here. Here goes the answer:

**_______________________________________________________________**

# Answer for the Problem:

A Windows host (DESKTOP-5QS3D5D) used by Patrick Zimmerman was infected with IcedID malware that led to Cobalt Strike.

Domains for the IcedID malware:

> oceriesfornot.top , antnosience.com , suncoastpinball.com

Domains where suspicious traffic was detected:

> filebin.net , situla.bitbit.net

Domain where Cobalt Strike happened:

> bupdater.com

**_______________________________________________________________**

Do follow me for more Malware and Packet Analysis blogs!!

Signing off, RDT.